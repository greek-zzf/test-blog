<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>Hello World</title>
    <link href="/2022/12/18/hello-world/"/>
    <url>/2022/12/18/hello-world/</url>
    
    <content type="html"><![CDATA[<p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo new <span class="hljs-string">&quot;My New Post&quot;</span><br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo server<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo generate<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs bash">$ hexo deploy<br></code></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>Cookie</title>
    <link href="/2021/03/17/Cookie/"/>
    <url>/2021/03/17/Cookie/</url>
    
    <content type="html"><![CDATA[<p>不知道大家是否想过这样一个问题，比如说我们登陆淘宝之后，点击订单，点击购物车，这些都是自己的信息。通过前面的学习，我们也知道 HTTP 协议是无状态的，我们与淘宝的服务器之间，只是通过一串串字节在交流。我们发送请求，就是发给服务器一串字节流，服务器收到后作出响应，也返回一串字节流。当我们点击「购物车」，点击「订单」他怎么知道是「我」在查看购物车信息，而不是张三在查看购物车呢？</p><p>我们想到一种笨拙的解决办法：当我们点击购物车的时候，系统让你登陆账号密码，登陆之后就能正确访问你的信息了。当我们点击其他信息时，比如「订单」，系统也让你输入账号密码，这样订单信息也能正确访问了。这种方法是一种解决办法，但是给用户带来的体验很不好。cookie 就是用来维持登陆状态的东西。</p><p><strong>Cookie 是什么</strong> </p><p>简单来说就是一串字符串数据，用来区分和辨别不同用户。可以理解为「身份证」，通过身份证这一串数据，我们就能知道是谁在访问服务器。当然这一字符串可能还会包含，Cookie 的过期时间，以及一些安全协议等等。</p><p><strong>Cookie 如何维持状态</strong>当我们第一次登陆一个网站的时候，我们填写好自己的账号密码信息，向服务器发送登陆请求。服务器根据你传过来的账号密码进行判断，倘若账号密码正确，服务器就会返回登陆成功的信息，并且在返回的 response header 中使用 <code>Set-Cookie</code>  参数，设置一段随机字符串 Cookie。</p><p>当我们有了 Cookie 之后，我们发出去的所有请求，浏览器都会帮我们把 Cookie 字符串带上，服务器就根据 Cookie 信息来辨别用户，返回正确的用户信息。</p><p><strong>使用 Java 代码获取 Cookie 信息</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Crawler</span> &#123;<br><br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">COOKIE_URL</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;http://47.91.156.35:8000/auth/login&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">String</span> <span class="hljs-variable">MESSAGE_URL</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;http://47.91.156.35:8000/auth&quot;</span>;<br>    <span class="hljs-keyword">private</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">final</span> <span class="hljs-type">CloseableHttpClient</span> <span class="hljs-variable">httpclient</span> <span class="hljs-operator">=</span> HttpClients.createDefault();<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">loginAndGetResponse</span><span class="hljs-params">(String username, String password)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br><br>        <span class="hljs-type">HttpPost</span> <span class="hljs-variable">httpPost</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpPost</span>(COOKIE_URL);<br>        httpPost.addHeader(<span class="hljs-string">&quot;Content-Type&quot;</span>, <span class="hljs-string">&quot;application/json&quot;</span>);<br>        httpPost.addHeader(<span class="hljs-string">&quot;User-Agent&quot;</span>, <span class="hljs-string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/84.0.4147.105 Safari/537.36&quot;</span>);<br><br>        Map&lt;String, String&gt; map = <span class="hljs-keyword">new</span> <span class="hljs-title class_">HashMap</span>&lt;&gt;(<span class="hljs-number">16</span>);<br>        map.put(<span class="hljs-string">&quot;username&quot;</span>, username);<br>        map.put(<span class="hljs-string">&quot;password&quot;</span>, password);<br><br>        <span class="hljs-type">HttpEntity</span> <span class="hljs-variable">entity</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">StringEntity</span>(JSON.toJSONString(map));<br>        httpPost.setEntity(entity);<br>        <span class="hljs-type">CloseableHttpResponse</span> <span class="hljs-variable">loginResponse</span> <span class="hljs-operator">=</span> httpclient.execute(httpPost);<br><br>        <span class="hljs-type">String</span> <span class="hljs-variable">result</span> <span class="hljs-operator">=</span> getMessageByCookie(loginResponse.getFirstHeader(<span class="hljs-string">&quot;Set-Cookie&quot;</span>).getValue());<br>        loginResponse.close();<br><br>        <span class="hljs-keyword">return</span> result;<br>    &#125;<br><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> String <span class="hljs-title function_">getMessageByCookie</span><span class="hljs-params">(String cookie)</span> <span class="hljs-keyword">throws</span> IOException &#123;<br>        <span class="hljs-type">HttpGet</span> <span class="hljs-variable">httpGet</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">HttpGet</span>(MESSAGE_URL);<br>        httpGet.addHeader(<span class="hljs-string">&quot;Cookie&quot;</span>, cookie);<br>        <span class="hljs-type">CloseableHttpResponse</span> <span class="hljs-variable">response</span> <span class="hljs-operator">=</span> httpclient.execute(httpGet);<br><br>        <span class="hljs-type">HttpEntity</span> <span class="hljs-variable">entity1</span> <span class="hljs-operator">=</span> response.getEntity();<br>        <span class="hljs-type">InputStream</span> <span class="hljs-variable">is</span> <span class="hljs-operator">=</span> entity1.getContent();<br>        <span class="hljs-comment">// 设置解析编码为UTF-8</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">html</span> <span class="hljs-operator">=</span> IOUtils.toString(is, <span class="hljs-string">&quot;UTF-8&quot;</span>);<br>        EntityUtils.consume(entity1);<br>        response.close();<br>        <span class="hljs-keyword">return</span> html;<br>    &#125;<br>&#125;<br><br></code></pre></td></tr></table></figure><p>使用给定的用户名 username 和密码 password 进行模拟登录，然后获取服务器返回的 <code>Cookie</code>的值，并把获取到的 Cookie 带到下一次的请求中去访问个人信息。</p><p>首先新建一个 HttpPost 对象，添加所需的头部信息。 <code>Content-type</code> 告诉服务器我们要给服务器发送的数据类型。 <code>User-Agent</code> 让我们模拟浏览器的方式去访问，避免被服务器屏蔽请求。</p><p>使用 Map 对象将我们得账号密码存储起来，接着使用 JSON 工具转化为字符串，放到请求体中，执行 POST 请求，把返回的头部信息 <code>Set-Cookie</code> 的值拿到。</p><p>使用 <code>getMessageByCookie</code> 方法，把获取到的 Cookie 值当做参数传入。方法中发送了一个 HttpGet 请求，把Cookie加到请求头中，发送到服务器，并把返回的 body 数据转化为字符串，返回去。</p><p>这样就是一次使用获取 Cookie ，并使用 Cookie 的简单访问。</p>]]></content>
    
    
    
    <tags>
      
      <tag>Cookie</tag>
      
      <tag>Web</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
